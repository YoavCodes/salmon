<h1>Forms</h1>

<p>A form element in Javascript template notation looks like this:</p>
<pre class="prettyprint lang-javascript">
\`\`\`form\`, { class: \`cform\`, 
		id: \`cform1\`, 
		method: \`post\`, 
		ajaxform: true, 
		hashbang: \`news/postcomment\`, 
		command: \`\`, 
		parseValidate: \`fin.fn.new.postComment_validate\`,
		onSuccess: \`fin.fn.news.postComment_success\`, 
		onError: \`fin.fn.news.postComment_error\`
		},
		rootNode, \`\`
		);

</pre>
<p><span class="prettyprint">class</span> and <span class="prettyprint">id</span> are typical element attributes along with rootNode which is the parent element of the form.</p>

<p><span class="prettyprint">method</span> is either post or get</p>
<p><span class="prettyprint">ajaxform</span> is true, if you're not creating an ajax form the entire page will reload and you would specify an action attribute instead</p>
<p><span class="prettyprint">hashbang</span> and <span class="prettyprint">command</span> are used by server-side routing to call the corrent controller</p>
<p><span class="prettyprint">onSuccess</span> and <span class="prettyprint">onError</span> are both referencing client-side functions which have been automatically namespaced using export notation in fn.js templates. There are global success and error handlers for ajaxforms which will be overridden if specified here</p>
<p>The <span class="prettyprint">parseValidate</span> function, if specified, will be used to determine if the form can be sent and perform client-side validation, it must return true or false.</p>

<p>If <span class="prettyprint">ajaxForm</span> is set to true, an iframe is immediately created next to the form and targeted whenever it's rendered. This will prevent an ajaxForm from reloading the page if the submit() function fails.</p>

<p>When a form is actually submitted however, a new iframe is created in the document body with a unique id and name and this new iframe is targeted. This allows you to submit a form multiple times asynchronously by default. This could also be limited manually to wait for a response before becoming active again.</p>

<p>The server will respond to ajaxforms with the same json object used for data retrival during navigation, but with extra padding, ie: json-p. the json-p calls a jsonp handler function which provides generic error handling for connection errors, cleans up the async iframe window that was being used, determines if the res.meta.status is a 200 or error, and passes the response on to the onSuccess or onError handlers if they were specified and exist.</p>

<p>This approach gives us cross browser ajax support that also supports file uploads.</p>

<p>note: The default behaviour with form reponses is for <span class="prettyprint">fin.data</span> to be automatically extended and updated with the response data, and as such <span class="prettyprint">res.data</span> should follow a global tree structure for your app's data.</p>

